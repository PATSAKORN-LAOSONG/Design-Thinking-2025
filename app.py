import streamlit as st
import pandas as pd

st.set_page_config(page_title="à¸£à¸°à¸šà¸šà¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸„à¸§à¸²à¸¡à¸”à¸±à¸™", layout="centered")

st.title("ğŸ©º à¸£à¸°à¸šà¸šà¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸•")
st.write("à¸à¸£à¸­à¸à¸„à¹ˆà¸²à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸• à¸£à¸°à¸šà¸šà¸ˆà¸°à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸£à¸°à¸”à¸±à¸šà¸•à¸²à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸à¹„à¸Ÿà¸¥à¹Œ CSV")

# =========================
# à¹‚à¸«à¸¥à¸”à¹„à¸Ÿà¸¥à¹Œ CSV
# =========================
@st.cache_data
def load_data():
    df = pd.read_csv("table_1.csv")
    df.columns = df.columns.str.strip()
    return df

df = load_data()

# =========================
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¹„à¸Ÿà¸¥à¹Œà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥
# =========================
if df.empty:
    st.error("à¹„à¸Ÿà¸¥à¹Œ CSV à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥")
    st.stop()

# à¹ƒà¸Šà¹‰à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¹à¸£à¸à¹€à¸›à¹‡à¸™à¸Šà¸·à¹ˆà¸­à¸£à¸°à¸”à¸±à¸š (à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©à¸ˆà¸²à¸ Excel)
category_col = df.columns[0]

# =========================
# à¸£à¸±à¸šà¸„à¹ˆà¸²à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰
# =========================
sys = st.number_input("à¸„à¹ˆà¸² SYSTOLIC (à¸•à¸±à¸§à¸šà¸™)", 0, 300, 120)
dia = st.number_input("à¸„à¹ˆà¸² DIASTOLIC (à¸•à¸±à¸§à¸¥à¹ˆà¸²à¸‡)", 0, 200, 80)

# =========================
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸”à¸±à¸š
# =========================
if st.button("ğŸ” à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™"):

    st.subheader("ğŸ“Š à¸œà¸¥à¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™")

    # 1ï¸âƒ£ à¸„à¸³à¸™à¸§à¸“à¸£à¸°à¸”à¸±à¸šà¸•à¸²à¸¡à¹€à¸à¸“à¸‘à¹Œà¸¡à¸²à¸•à¸£à¸à¸²à¸™
    if sys >= 180 or dia >= 120:
        level = 5
    elif sys >= 140 or dia >= 90:
        level = 4
    elif sys >= 130 or dia >= 80:
        level = 3
    elif sys >= 120 and dia < 80:
        level = 2
    else:
        level = 1

    # 2ï¸âƒ£ à¸”à¸¶à¸‡à¸Šà¸·à¹ˆà¸­à¸£à¸°à¸”à¸±à¸šà¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©à¸ˆà¸²à¸à¹„à¸Ÿà¸¥à¹Œ CSV
    df_sorted = df.reset_index(drop=True)

    if level <= len(df_sorted):
        result_en = str(df_sorted.iloc[level - 1][category_col]).strip()
    else:
        result_en = "à¹„à¸¡à¹ˆà¸à¸šà¸£à¸°à¸”à¸±à¸š"

    # 3ï¸âƒ£ à¹à¸›à¸¥à¹€à¸›à¹‡à¸™à¸ à¸²à¸©à¸²à¹„à¸—à¸¢
    # à¹à¸ªà¸”à¸‡à¸œà¸¥à¸•à¸²à¸¡à¸£à¸°à¸”à¸±à¸š (à¸‡à¹ˆà¸²à¸¢à¹†)

    if level == 5:
        st.error(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©: {result_en}")
        st.error(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¹„à¸—à¸¢: {result_th}")

    elif level == 4:
        st.error(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©: {result_en}")
        st.error(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¹„à¸—à¸¢: {result_th}")

    elif level == 3:
        st.warning(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©: {result_en}")
        st.warning(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¹„à¸—à¸¢: {result_th}")

    elif level == 2:
        st.info(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©: {result_en}")
        st.info(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¹„à¸—à¸¢: {result_th}")

    else:
        st.success(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©: {result_en}")
        st.success(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¹„à¸—à¸¢: {result_th}")
