import streamlit as st
import pandas as pd

st.set_page_config(page_title="à¸£à¸°à¸šà¸šà¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸„à¸§à¸²à¸¡à¸”à¸±à¸™", layout="centered")

st.title("ğŸ©º à¸£à¸°à¸šà¸šà¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸•")

# =========================
# à¹‚à¸«à¸¥à¸”à¹„à¸Ÿà¸¥à¹Œ CSV
# =========================
@st.cache_data
def load_data():
    df = pd.read_csv("table_1.csv")
    df.columns = df.columns.str.strip()
    return df

df = load_data()

if df.empty:
    st.error("à¹„à¸Ÿà¸¥à¹Œ CSV à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥")
    st.stop()

category_col = df.columns[0]

# =========================
# à¸£à¸±à¸šà¸„à¹ˆà¸²à¸„à¸§à¸²à¸¡à¸”à¸±à¸™
# =========================
sys = st.number_input("à¸„à¹ˆà¸² SYSTOLIC (à¸•à¸±à¸§à¸šà¸™)", 0, 300, 120)
dia = st.number_input("à¸„à¹ˆà¸² DIASTOLIC (à¸•à¸±à¸§à¸¥à¹ˆà¸²à¸‡)", 0, 200, 80)

# =========================
# à¸à¸”à¸›à¸¸à¹ˆà¸¡à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š
# =========================
if st.button("ğŸ” à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™"):

    # à¸„à¸³à¸™à¸§à¸“à¸£à¸°à¸”à¸±à¸š
    if sys >= 180 or dia >= 120:
        level = 5
    elif sys >= 140 or dia >= 90:
        level = 4
    elif sys >= 130 or dia >= 80:
        level = 3
    elif sys >= 120 and dia < 80:
        level = 2
    else:
        level = 1

    df_sorted = df.reset_index(drop=True)

    if level <= len(df_sorted):
        result_en = str(df_sorted.iloc[level - 1][category_col]).strip()
    else:
        result_en = "à¹„à¸¡à¹ˆà¸à¸šà¸£à¸°à¸”à¸±à¸š"

    # =========================
    # à¹à¸›à¸¥à¹„à¸—à¸¢ + à¸„à¸³à¹à¸™à¸°à¸™à¸³
    # =========================

    if level == 5:
        result_th = "à¸ à¸²à¸§à¸°à¸§à¸´à¸à¸¤à¸•à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸•à¸ªà¸¹à¸‡"
        advice = "âš ï¸ à¸£à¸°à¸”à¸±à¸šà¸­à¸±à¸™à¸•à¸£à¸²à¸¢à¸¡à¸²à¸ à¸„à¸§à¸£à¸à¸šà¹à¸à¸—à¸¢à¹Œà¸—à¸±à¸™à¸—à¸µ"
        st.error(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©: {result_en}")
        st.error(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¹„à¸—à¸¢: {result_th}")
        st.error(advice)

    elif level == 4:
        result_th = "à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸•à¸ªà¸¹à¸‡ à¸£à¸°à¸”à¸±à¸šà¸—à¸µà¹ˆ 2"
        advice = "à¸„à¸§à¸£à¸›à¸£à¸¶à¸à¸©à¸²à¹à¸à¸—à¸¢à¹Œ à¹à¸¥à¸°à¸„à¸§à¸šà¸„à¸¸à¸¡à¸­à¸²à¸«à¸²à¸£ à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢à¸ªà¸¡à¹ˆà¸³à¹€à¸ªà¸¡à¸­"
        st.error(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©: {result_en}")
        st.error(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¹„à¸—à¸¢: {result_th}")
        st.warning(advice)

    elif level == 3:
        result_th = "à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸•à¸ªà¸¹à¸‡ à¸£à¸°à¸”à¸±à¸šà¸—à¸µà¹ˆ 1"
        advice = "à¸„à¸§à¸£à¸¥à¸”à¹€à¸„à¹‡à¸¡ à¸¥à¸”à¸¡à¸±à¸™ à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢ à¹à¸¥à¸°à¸•à¸´à¸”à¸•à¸²à¸¡à¸­à¸²à¸à¸²à¸£"
        st.warning(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©: {result_en}")
        st.warning(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¹„à¸—à¸¢: {result_th}")
        st.info(advice)

    elif level == 2:
        result_th = "à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸²à¸›à¸à¸•à¸´à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢"
        advice = "à¸„à¸§à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¸­à¸²à¸«à¸²à¸£à¹à¸¥à¸°à¸•à¸´à¸”à¸•à¸²à¸¡à¸­à¸²à¸à¸²à¸£à¸­à¸¢à¹ˆà¸²à¸‡à¸ªà¸¡à¹ˆà¸³à¹€à¸ªà¸¡à¸­"
        st.info(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©: {result_en}")
        st.info(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¹„à¸—à¸¢: {result_th}")
        st.info(advice)

    else:
        result_th = "à¸›à¸à¸•à¸´"
        advice = "à¸£à¸±à¸à¸©à¸²à¸à¸¤à¸•à¸´à¸à¸£à¸£à¸¡à¸ªà¸¸à¸‚à¸ à¸²à¸à¸—à¸µà¹ˆà¸”à¸µà¸•à¹ˆà¸­à¹„à¸›"
        st.success(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©: {result_en}")
        st.success(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¹„à¸—à¸¢: {result_th}")
        st.success(advice)
