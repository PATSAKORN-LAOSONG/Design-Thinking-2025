import streamlit as st
import pandas as pd

st.set_page_config(page_title="à¸£à¸°à¸šà¸šà¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸„à¸§à¸²à¸¡à¸”à¸±à¸™", layout="centered")

st.title("ğŸ©º à¸£à¸°à¸šà¸šà¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸•")
st.write("à¸à¸£à¸­à¸à¸„à¹ˆà¸²à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸• à¸£à¸°à¸šà¸šà¸ˆà¸°à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸£à¸°à¸”à¸±à¸šà¸•à¸²à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸à¹„à¸Ÿà¸¥à¹Œ CSV")

# =========================
# à¹‚à¸«à¸¥à¸”à¹„à¸Ÿà¸¥à¹Œ CSV
# =========================
@st.cache_data
def load_data():
    df = pd.read_csv("table_1.csv")
    df.columns = df.columns.str.strip()  # à¸¥à¸šà¸Šà¹ˆà¸­à¸‡à¸§à¹ˆà¸²à¸‡à¸«à¸±à¸§à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œ
    return df

df = load_data()

# =========================
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¹„à¸Ÿà¸¥à¹Œà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥
# =========================
if df.empty:
    st.error("à¹„à¸Ÿà¸¥à¹Œ CSV à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥")
    st.stop()

# à¹ƒà¸Šà¹‰à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¹à¸£à¸à¹€à¸›à¹‡à¸™à¸Šà¸·à¹ˆà¸­à¸£à¸°à¸”à¸±à¸š
category_col = df.columns[0]

# =========================
# à¸£à¸±à¸šà¸„à¹ˆà¸²à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰
# =========================
sys = st.number_input("à¸„à¹ˆà¸² SYSTOLIC (à¸•à¸±à¸§à¸šà¸™)", 0, 300, 120)
dia = st.number_input("à¸„à¹ˆà¸² DIASTOLIC (à¸•à¸±à¸§à¸¥à¹ˆà¸²à¸‡)", 0, 200, 80)

# =========================
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸”à¸±à¸š
# =========================
if st.button("ğŸ” à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™"):

    st.subheader("ğŸ“Š à¸œà¸¥à¸à¸²à¸£à¸›à¸£à¸°à¹€à¸¡à¸´à¸™")

    # 1ï¸âƒ£ à¸„à¸³à¸™à¸§à¸“à¸£à¸°à¸”à¸±à¸šà¸•à¸²à¸¡à¹€à¸à¸“à¸‘à¹Œà¸¡à¸²à¸•à¸£à¸à¸²à¸™
    if sys >= 180 or dia >= 120:
        level = 5
    elif sys >= 140 or dia >= 90:
        level = 4
    elif sys >= 130 or dia >= 80:
        level = 3
    elif sys >= 120 and dia < 80:
        level = 2
    else:
        level = 1

    # 2ï¸âƒ£ à¸”à¸¶à¸‡à¸Šà¸·à¹ˆà¸­à¸£à¸°à¸”à¸±à¸šà¸ˆà¸²à¸à¹„à¸Ÿà¸¥à¹Œ CSV
    df_sorted = df.reset_index(drop=True)

    if level <= len(df_sorted):
        result = str(df_sorted.iloc[level - 1][category_col]).strip()
    else:
        result = "à¹„à¸¡à¹ˆà¸à¸šà¸£à¸°à¸”à¸±à¸š"

    # 3ï¸âƒ£ à¹à¸ªà¸”à¸‡à¸œà¸¥
    st.success(f"à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸„à¸·à¸­: **{result}**")

    # à¹à¸ªà¸”à¸‡à¸„à¸³à¹€à¸•à¸·à¸­à¸™à¸•à¸²à¸¡à¸£à¸°à¸”à¸±à¸š
    if level == 5:
        result = "à¸ à¸²à¸§à¸°à¸§à¸´à¸à¸¤à¸•à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸•à¸ªà¸¹à¸‡"
        st.error("âš ï¸ à¸£à¸°à¸”à¸±à¸šà¸­à¸±à¸™à¸•à¸£à¸²à¸¢à¸¡à¸²à¸ à¸„à¸§à¸£à¸à¸šà¹à¸à¸—à¸¢à¹Œà¸—à¸±à¸™à¸—à¸µ")
    elif level == 4:
        result = "à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸•à¸ªà¸¹à¸‡ à¸£à¸°à¸”à¸±à¸šà¸—à¸µà¹ˆ 2"
        st.error("âš ï¸ à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ªà¸¹à¸‡à¸£à¸°à¸”à¸±à¸š 2 à¸„à¸§à¸£à¸›à¸£à¸¶à¸à¸©à¸²à¹à¸à¸—à¸¢à¹Œ")
    elif level == 3:
        result = "à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸•à¸ªà¸¹à¸‡ à¸£à¸°à¸”à¸±à¸šà¸—à¸µà¹ˆ 1"
        st.warning("à¸„à¸§à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¸­à¸²à¸«à¸²à¸£à¹à¸¥à¸°à¸•à¸´à¸”à¸•à¸²à¸¡à¸­à¸²à¸à¸²à¸£")
    elif level == 2:
        result = "à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸²à¸›à¸à¸•à¸´à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢"
        st.info("à¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹€à¸£à¸´à¹ˆà¸¡à¸ªà¸¹à¸‡ à¸„à¸§à¸£à¸›à¸£à¸±à¸šà¸à¸¤à¸•à¸´à¸à¸£à¸£à¸¡")
    else:
        result = "à¸›à¸à¸•à¸´"
        st.success("à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸£à¸°à¸”à¸±à¸šà¸›à¸à¸•à¸´")
